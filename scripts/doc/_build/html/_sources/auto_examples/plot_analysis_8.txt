

.. _sphx_glr_auto_examples_plot_analysis_8.py:


===========================
Plotting the analysis chain
===========================

Run the analysis.



.. code-block:: python


    import os.path as op
    import numpy as np

    from mayavi import mlab
    import mne

    mlab.close(all=True)

    def plot_stc(cond):
        fname = op.join(meg_dir, subject, 'mne_dSPM_inverse-%s' % cond)
        stc = mne.read_source_estimate(fname, subject)
        brain = stc.plot(subject=subject, subjects_dir=subjects_dir, views=['cau'],
                         hemi='both', time_viewer=False)
        del stc
        return brain

    study_path = op.join(op.dirname("__file__"), '..', '..')
    subjects_dir = op.join(study_path, 'subjects')
    meg_dir = op.join(study_path, 'MEG')


    #subject_id = os.getenv("SUBJECT_ID")
    #print(subject_id)
    #subject_id = 1
    # Configuration

    # Raw data
    #fname = op.join(study_path, 'ds117', subject, 'MEG', 'run_01_raw.fif')
    #raw = mne.io.Raw(fname)

    #fname = op.join(meg_dir, subject, 'run_01_filt_sss_raw.fif')
    #raw_filt = mne.io.Raw(fname)
    subject = "sub%03d" % int(8)







Filtering
raw.plot_psd()
raw_filt.plot_psd()


Evoked responses



.. code-block:: python

    evo_fname = op.join(meg_dir, subject, '%s-ave.fif' % subject)
    evoked = mne.read_evokeds(evo_fname)







Faces



.. code-block:: python

    famous_evo, scrambled_evo, unfamiliar_evo, contrast_evo, faces_evo = evoked
    faces_evo.plot(spatial_colors=True, gfp=True, ylim={'eeg': (-10, 10)},
                   window_title='Faces %s' % subject)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_001.png
    :align: center




Famous



.. code-block:: python


    famous_evo.plot(spatial_colors=True, gfp=True,
                    window_title='Famous %s' % subject)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_002.png
    :align: center




Scrambled



.. code-block:: python

    scrambled_evo.plot(spatial_colors=True, gfp=True,
                       window_title='Scrambled %s' % subject)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_003.png
    :align: center




Unfamiliar



.. code-block:: python

    unfamiliar_evo.plot(spatial_colors=True, gfp=True,
                        window_title='Unfamiliar %s' % subject)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_004.png
    :align: center




Faces - scrambled



.. code-block:: python

    contrast_evo.plot(spatial_colors=True, gfp=True,
                      window_title='Faces - scrambled %s' % subject)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_005.png
    :align: center




Topomaps



.. code-block:: python

    times = np.arange(0.05, 0.3, 0.05)
    famous_evo.plot_topomap(times=times, title='Famous %s' % subject)
    scrambled_evo.plot_topomap(times=times, title='Scrambled %s' % subject)
    unfamiliar_evo.plot_topomap(times=times, title='Unfamiliar %s' % subject)
    contrast_evo.plot_topomap(times=times, title='Faces - scrambled %s' % subject)




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_006.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_007.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_008.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_009.png
            :scale: 47


.. rst-class:: sphx-glr-script-out

 Out::

    Disabling interactive colorbar for multiple axes. Turn interactivity on explicitly by passing cmap as a tuple.
    Disabling interactive colorbar for multiple axes. Turn interactivity on explicitly by passing cmap as a tuple.
    Disabling interactive colorbar for multiple axes. Turn interactivity on explicitly by passing cmap as a tuple.
    Disabling interactive colorbar for multiple axes. Turn interactivity on explicitly by passing cmap as a tuple.


TFR



.. code-block:: python

    fpower = mne.time_frequency.read_tfrs(
        op.join(meg_dir, subject, '%s-faces-tfr.h5' % subject))[0]
    fitc = mne.time_frequency.read_tfrs(
        op.join(meg_dir, subject, '%s-itc_faces-tfr.h5' % subject))[0]
    spower = mne.time_frequency.read_tfrs(
        op.join(meg_dir, subject, '%s-scrambled-tfr.h5' % subject))[0]
    sitc = mne.time_frequency.read_tfrs(
        op.join(meg_dir, subject, '%s-itc_scrambled-tfr.h5' % subject))[0]
    channel = 'EEG070'
    idx = [fpower.ch_names.index(channel)]
    fpower.plot(idx, title='Faces power %s' % channel, baseline=(-0.1, 0.0),
                mode='logratio')
    spower.plot(idx, title='Scrambled power %s' % channel, baseline=(-0.1, 0.0),
                mode='logratio')
    fitc.plot(idx, title='Faces ITC %s' % channel, baseline=(-0.1, 0.0),
              mode='logratio')
    sitc.plot(idx, title='Scrambled ITC %s' % channel, baseline=(-0.1, 0.0),
              mode='logratio')





.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_010.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_011.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_012.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_013.png
            :scale: 47




Covariance



.. code-block:: python

    cov = mne.read_cov(op.join(meg_dir, subject, '%s-cov.fif' % subject))
    mne.viz.plot_cov(cov, faces_evo.info)
    faces_evo.plot_white(cov)




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_014.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_015.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_analysis_8_016.png
            :scale: 47


.. rst-class:: sphx-glr-script-out

 Out::

    No average EEG reference present in info["projs"], covariance may be adversely affected. Consider recomputing covariance using a raw file with an average eeg reference projector added.


Trans



.. code-block:: python

    fname_trans = op.join(study_path, 'ds117', subject, 'MEG',
                          '%s-trans.fif' % subject)
    mne.viz.plot_trans(famous_evo.info, fname_trans, subject=subject,
                       subjects_dir=subjects_dir, meg_sensors=True,
                       eeg_sensors=True)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_017.png
    :align: center




Faces



.. code-block:: python

    brain = plot_stc('faces')
    brain.set_data_time_index(407)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_018.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    The time_unit parameter default will change from 'ms' to 's' in MNE 0.14. To avoid this warning specify the parameter explicitly.
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=2.06e+00 fmid=2.25e+00 fmax=3.56e+00 transparent=1
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=2.06e+00 fmid=2.25e+00 fmax=3.56e+00 transparent=1


Famous



.. code-block:: python

    brain = plot_stc('famous')
    brain.set_data_time_index(407)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_019.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    The time_unit parameter default will change from 'ms' to 's' in MNE 0.14. To avoid this warning specify the parameter explicitly.
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=2.01e+00 fmid=2.19e+00 fmax=3.45e+00 transparent=1
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=2.01e+00 fmid=2.19e+00 fmax=3.45e+00 transparent=1


Unfamiliar



.. code-block:: python

    brain = plot_stc('unfamiliar')
    brain.set_data_time_index(407)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_020.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    The time_unit parameter default will change from 'ms' to 's' in MNE 0.14. To avoid this warning specify the parameter explicitly.
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=2.01e+00 fmid=2.19e+00 fmax=3.41e+00 transparent=1
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=2.01e+00 fmid=2.19e+00 fmax=3.41e+00 transparent=1


Scrambled



.. code-block:: python

    brain = plot_stc('scrambled')
    brain.set_data_time_index(407)




.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_021.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    The time_unit parameter default will change from 'ms' to 's' in MNE 0.14. To avoid this warning specify the parameter explicitly.
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=9.07e+00 fmid=1.14e+01 fmax=3.51e+01 transparent=1
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=9.07e+00 fmid=1.14e+01 fmax=3.51e+01 transparent=1


Faces - scrambled



.. code-block:: python

    brain = plot_stc('contrast')
    brain.set_data_time_index(407)



.. image:: /auto_examples/images/sphx_glr_plot_analysis_8_022.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    The time_unit parameter default will change from 'ms' to 's' in MNE 0.14. To avoid this warning specify the parameter explicitly.
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=7.40e+00 fmid=9.28e+00 fmax=2.84e+01 transparent=1
    Updating smoothing matrix, be patient..
    Smoothing matrix creation, step 1
    Smoothing matrix creation, step 2
    Smoothing matrix creation, step 3
    Smoothing matrix creation, step 4
    Smoothing matrix creation, step 5
    Smoothing matrix creation, step 6
    Smoothing matrix creation, step 7
    Smoothing matrix creation, step 8
    Smoothing matrix creation, step 9
    Smoothing matrix creation, step 10
    colormap: fmin=7.40e+00 fmid=9.28e+00 fmax=2.84e+01 transparent=1


**Total running time of the script:** ( 0 minutes  40.913 seconds)



.. container:: sphx-glr-download

    :download:`Download Python source code: plot_analysis_8.py <plot_analysis_8.py>`



.. container:: sphx-glr-download

    :download:`Download Jupyter notebook: plot_analysis_8.ipynb <plot_analysis_8.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <http://sphinx-gallery.readthedocs.io>`_
